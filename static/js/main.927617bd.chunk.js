(this["webpackJsonpcovitrack-frontend"]=this["webpackJsonpcovitrack-frontend"]||[]).push([[0],{202:function(e,t,n){"use strict";n.r(t);var r=n(6),c=n(1),a=n.n(c),o=n(89),u=n.n(o),i=n(24),s=n(17),f=n(18),l=n(50),j=n.n(l),b=n(16),d=n(10),O=n(8),v=n(0),h=n(20),p=n.n(h),m=n(49),x="yyyyMMdd",g=100,y="https://tmikoss.github.io/covitrack",w=n(30),k=Object(w.a)((function(e){return{countries:{},loaded:!1,load:function(){var t=Object(m.a)(p.a.mark((function t(){var n,r,c,a,o,u,i,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(y,"/api/cases.json"));case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,c={},a=Object(O.a)(r);try{for(a.s();!(o=a.n()).done;)u=o.value,i=u.country,s=u.newCases,c[i]=s}catch(f){a.e(f)}finally{a.f()}e({countries:c,loaded:!0});case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}})),D=function(e){return e.loaded},C=function(e){return e.load},M=n(95),L=Object(w.a)((function(e){var t=Object(M.a)(new Date,2);return{focusDate:t,minDate:new Date(2020,0,1),maxDate:t,setFocusDate:function(t){return e({focusDate:t})}}})),I=n(32),R=function(e,t){var n=(90-t)*(Math.PI/180),r=(e+180)*(Math.PI/180),c=-100*Math.sin(n)*Math.cos(r),a=g*Math.sin(n)*Math.sin(r);return[c,g*Math.cos(n),a]},E=function(e){var t=e.country,n=t.code,a=t.features,o=Object(s.f)(),u=Object(c.useRef)(k.getState().countries[n]||{}),i=Object(c.useRef)(k.getState().countries.OWID_WRL||{}),l=Object(c.useRef)(Object(I.a)(L.getState().focusDate,x)),j=Object(c.useRef)(new v.Color(o.minLevel)),h=new v.Color(o.maxLevel);Object(c.useEffect)((function(){return k.subscribe((function(e){u.current=e[n]||{},i.current=e.OWID_WRL||{}}),(function(e){return e.countries}))}),[n]),Object(c.useEffect)((function(){return L.subscribe((function(e){return l.current=Object(I.a)(e,x)}),(function(e){return e.focusDate}))}),[n]);var p,m=new v.LineBasicMaterial({color:o.minLevel}),g=[],y=Object(O.a)(a);try{for(y.s();!(p=y.n()).done;){var w,D=p.value.coordinates,C=[],M=Object(O.a)(D);try{for(M.s();!(w=M.n()).done;){var E=w.value,S=R.apply(void 0,Object(b.a)(E));C.push.apply(C,Object(b.a)(S))}}catch(P){M.e(P)}finally{M.f()}var B=new v.BufferGeometry;B.setAttribute("position",new v.Float32BufferAttribute(C,3));var W={geometry:B,material:m};g.push(Object(r.jsx)("line",Object(d.a)({},W),g.length))}}catch(P){y.e(P)}finally{y.f()}return Object(f.c)((function(){var e=u.current[l.current]||0,t=i.current[l.current]||0,n=0;t>0&&(n=e/(5*t)),j.current=new v.Color(o.minLevel).lerp(h,n),m.color.lerp(j.current,.1)})),Object(r.jsx)("group",{children:g})},S=n(204),B=n(99),W=n(100);Object(f.b)({OrbitControls:W.a});var P=function(){var e=Object(f.e)(),t=e.camera,n=e.gl.domElement,a=Object(c.useRef)();return Object(f.c)((function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.update()})),Object(r.jsx)("orbitControls",{ref:a,args:[t,n]})},F=n(94),_=Object(w.a)(Object(F.persist)((function(e){return{countries:[],loaded:!1,load:function(){var t=Object(m.a)(p.a.mark((function t(){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(y,"/api/countries.json"));case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,c=j()(r,(function(e){var t=e.code,n=e.name,r=e.geography,c=[];if("MultiPolygon"===r.type){var a,o=Object(O.a)(r.coordinates);try{for(o.s();!(a=o.n()).done;){var u,i=a.value,s=Object(O.a)(i);try{for(s.s();!(u=s.n()).done;){var f=u.value;c.push({coordinates:f})}}catch(d){s.e(d)}finally{s.f()}}}catch(d){o.e(d)}finally{o.f()}}else{var l,j=Object(O.a)(r.coordinates);try{for(j.s();!(l=j.n()).done;){var b=l.value;c.push({coordinates:b})}}catch(d){j.e(d)}finally{j.f()}}return{code:t,name:n,features:c}})),e({countries:c,loaded:!0});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}),{name:"countries-base-data"})),A=function(e){return e.loaded},G=function(e){return e.load},J=n(67),T=n(102),q=Object(c.memo)((function(){return 0===(Object(T.a)()||{tier:0}).tier?null:Object(r.jsx)(c.Suspense,{fallback:null,children:Object(r.jsx)(J.b,{children:Object(r.jsx)(J.a,{luminanceThreshold:.4,luminanceSmoothing:1,intensity:2},"bloom")})})})),z=function(){var e=Object(s.f)();return Object(r.jsxs)("mesh",{children:[Object(r.jsx)("sphereBufferGeometry",{args:[97,100,100]}),Object(r.jsx)("meshBasicMaterial",{color:e.background,side:1,transparent:!0,opacity:.95})]})},H=function(){var e=Object(s.f)(),t=_(Object(c.useCallback)((function(e){return e.countries}),[])),n=j()(t,(function(e){return Object(r.jsx)(E,{country:e},e.code)}));return Object(r.jsx)(f.a,{onCreated:function(t){return t.gl.setClearColor(e.background)},colorManagement:!1,children:Object(r.jsxs)(s.a.Provider,{value:e,children:[Object(r.jsx)(S.a,{fade:!0,factor:3}),Object(r.jsx)("ambientLight",{}),n,Object(r.jsx)(z,{}),Object(r.jsx)(B.a,{makeDefault:!0,near:.001,far:360,fov:90,position:[120,120,0]}),Object(r.jsx)(P,{}),Object(r.jsx)(q,{})]})})},K={background:"#060606",minLevel:"#ffffff",maxLevel:"#ff0000"},N=n(90),Q=n(7),U=n(68),V=n(37),X=n(101),Y=n.n(X);function Z(){var e=Object(i.a)(["\n  background-color: transparent;\n  border: none;\n  outline: none;\n"]);return Z=function(){return e},e}function $(){var e=Object(i.a)(["\n  grid-area: date;\n"]);return $=function(){return e},e}function ee(){var e=Object(i.a)(["\n  grid-area: avg;\n  white-space: nowrap;\n  overflow: hidden;\n"]);return ee=function(){return e},e}function te(){var e=Object(i.a)(["\n  flex: 1;\n"]);return te=function(){return e},e}function ne(){var e=Object(i.a)(["\n  grid-area: slider;\n  display: flex;\n  flex-flow: row;\n"]);return ne=function(){return e},e}function re(){var e=Object(i.a)(["\n  width: 100%;\n  position: absolute;\n  top: 0;\n  display: grid;\n  grid-template-columns: 20vw auto 20vw;\n  grid-template-areas: 'date slider avg';\n  align-items: center;\n  color: white;\n  text-align: center;\n\n  @media only screen and (max-width: 600px) {\n    grid-template-columns: 1fr 1fr;\n    grid-template-areas: 'slider slider'\n                         'date avg';\n  }\n"]);return re=function(){return e},e}var ce=s.e.div(re()),ae=s.e.div(ne()),oe=s.e.input(te()),ue=s.e.div(ee()),ie=s.e.div($()),se=s.e.button(Z()),fe={"-5":"\u23f8\ufe0f","-1":"\u23ea\ufe0f",0:"\u25c0\ufe0f",1:"\u25c0\ufe0f",5:"\u25c0\ufe0f"},le={"-5":0,"-1":-5,0:-1,1:-1,5:-1},je={"-5":"\u25b6\ufe0f","-1":"\u25b6\ufe0f",0:"\u25b6\ufe0f",1:"\u23e9\ufe0f",5:"\u23f8\ufe0f"},be={"-5":1,"-1":1,0:1,1:5,5:0},de=function(){var e=L(),t=e.minDate,n=e.maxDate,a=e.focusDate,o=e.setFocusDate,u=Object(c.useState)(0),i=Object(Q.a)(u,2),s=i[0],f=i[1],l=k(Object(c.useCallback)((function(e){return e.countries.OWID_WRL||{}}),[]))[Object(I.a)(a,x)]||0;Object(c.useEffect)((function(){var e=setInterval((function(){var e=Object(V.a)(a,s);s>0&&e<=n||s<0&&e>=t?o(e):s<0?(o(t),f(0)):s>0&&(o(n),f(0))}),100);return function(){return clearInterval(e)}}),[a,s]);var j=Object(U.a)(n,t),b=Object(U.a)(a,t),d=Object(c.useCallback)((function(){return f((function(e){return le[e]}))}),[]),O=Object(c.useCallback)((function(){return f((function(e){return be[e]}))}),[]);return Object(r.jsxs)(ce,{children:[Object(r.jsx)(ie,{children:Object(I.a)(a,"dd.MM.yyyy")}),Object(r.jsxs)(ae,{children:[Object(r.jsx)(se,{onClick:d,disabled:a===t,children:fe[s]}),Object(r.jsx)(oe,{type:"range",min:0,max:j,value:b,onChange:function(e){var n=e.target.value;f(0),o(Object(V.a)(t,parseInt(n)))}}),Object(r.jsx)(se,{onClick:O,disabled:a===n,children:je[s]})]}),Object(r.jsxs)(ue,{children:["avg ",Y()(l,2)," new cases / million"]})]})};function Oe(){var e=Object(i.a)(["\n  ","\n\n  #root {\n    height: 100vh;\n  }\n"]);return Oe=function(){return e},e}var ve=Object(s.c)(Oe(),N.a),he=function(){return function(){var e=_(A),t=_(G);Object(c.useEffect)((function(){e||t()}),[t,e])}(),function(){var e=k(D),t=k(C);Object(c.useEffect)((function(){e||t()}),[t,e])}(),Object(r.jsxs)(s.b,{theme:K,children:[Object(r.jsx)(ve,{}),Object(r.jsx)(H,{}),Object(r.jsx)(de,{})]})};u.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(he,{})}),document.getElementById("root"))}},[[202,1,2]]]);
//# sourceMappingURL=main.927617bd.chunk.js.map